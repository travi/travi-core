!function(a){"use strict";function b(a,b,c){var d,e=b.split("."),f=e.length;for(d=0;f>d;d+=1)void 0===a[e[d]]&&(a[e[d]]=d===f-1?c:{}),a=a[e[d]];return a}function c(a,b){var d,e;return 1===b.length?a[b[0]]:b.length>1&&(d=b.shift(),e=a[d])?c(e,b):void 0}function d(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet"),b.setAttribute("type","text/css"),b.setAttribute("href",a),document.getElementsByTagName("head")[0].appendChild(b)}function e(a,c){return b(this,a,c||{})}function f(a,b){e.call(this,a,b)}var g=function(){function a(a,b){c.call(d,a)||(d[a]=b)}function b(a){return d[a]}var c=Object.prototype.hasOwnProperty,d={};return{set:a,get:b}}();a.travi={getStyleSheet:d,namespace:e,register:f,putInObject:b,getFromObject:c,constants:g,enableConstants:g}}(this),travi.register=function(a,b,c){travi.namespace.call(this,a,b),travi.dependencies.checker.check("travi."+a,c)},function(a){"use strict";function b(a,b){var c=$.ajax({url:b,type:"get",dataType:"text",success:function(b){$.templates(a,b)}});return j[a]=c,c}function c(a,c){return j[a]?j[a]:b(a,c||h+a+i)}function d(a,b){var d,e=[];if("string"==typeof a)return c(a,b);for(d in a)a.hasOwnProperty(d)&&e.push(c(d,a[d]));return $.when.apply(null,e)}function e(a,b){return $.render[b](a||{})}function f(a,b,d){return d?void c(a).done(function(){d(e(b,a))}):e(b,a)}function g(){j={}}var h="/templates/",i=".tmpl",j={};$.views.helpers({toLower:function(a){return a.toLowerCase()}}),a.namespace("templates",{get:c,preLoad:d,render:f,init:g})}(travi),function(a,b){"use strict";var c=function(){a.location.reload()};b.namespace("browserProxy",{refresh:c})}(this,travi),function(a){"use strict";function b(a){var b=a.split("=");return{name:b[0],value:b[1]}}function c(a){return b(a).name}function d(a){return b(a).value}function e(a){for(;" "===a.charAt(0);)a=a.substring(1,a.length);return a}function f(a){var b,d,f,g=document.cookie.split(";");for(d=g.length,b=0;d>b;b+=1)if(f=e(g[b]),a===c(f))return f;return void 0}function g(){return document.cookie.split(";")}function h(a){return void 0!==f(a)}function i(a){var b=new Date;return b.setTime(b.getTime()+24*a*60*60*1e3),b}function j(a){return d(f(a))}function k(a){var b=i(a);return"; expires="+b.toGMTString()}function l(a,b,c){var d;d=c?k(c):"",document.cookie=a+"="+b+d+"; path=/"}function m(a){l(a,"",-1)}function n(){var a,b,d=g();for(a=d.length,b=0;a>b;b+=1)m(c(d[b]))}a.namespace("cookies",{exists:h,create:l,remove:m,clearAll:n,value:j})}(travi),function(a){"use strict";function b(){return{ENHANCEMENT_VERSION_KEY:c,DAYS_BEFORE_ENHANCEMENT_COOKIE_EXPIRATION:d,SMALL_SCREEN_CHOICE:e,LARGE_SCREEN_CHOICE:f,BASIC_CHOICE:g,LARGE_COOKIE_VALUE:i,SMALL_COOKIE_VALUE:h}}var c="ev",d=10,e="small",f="large",g="basic",h="s",i="l";a.namespace("enhancements.constants",{get:b})}(travi),function(a){"use strict";function b(a){c.create(e.ENHANCEMENT_VERSION_KEY,a,e.DAYS_BEFORE_ENHANCEMENT_COOKIE_EXPIRATION),d.refresh()}var c=a.cookies,d=a.browserProxy,e=a.enhancements.constants.get();a.namespace("enhancements.persist",{update:b})}(travi),function(a){"use strict";function b(){return Modernizr.mq("only screen and (min-width: 320px) and (max-width: 480px)")}function c(){g.create("svg",Modernizr.svg?"t":"f",i.DAYS_BEFORE_ENHANCEMENT_COOKIE_EXPIRATION)}function d(){h.update(b()?i.SMALL_COOKIE_VALUE:i.LARGE_COOKIE_VALUE)}function e(){g.exists(i.ENHANCEMENT_VERSION_KEY)||(c(),d())}function f(){e()}var g=a.cookies,h=a.enhancements.persist,i=a.enhancements.constants.get();a.namespace("enhancements.detection",{isSmallScreen:b,init:f}),f()}(travi),function(a){"use strict";function b(b){return a.getFromObject(l,b.split("."))}function c(b){var c=b.split(".");return c.shift(),a.getFromObject(a,c)}function d(a,d,e){var f,g={};if(a.init){for(f in e)e.hasOwnProperty(f)&&(g[f]=c(e[f]));a.init(g)}b(d).resolve()}function e(b){var d=new $.Deferred;return c(b)&&d.resolve(),a.putInObject(l,b,d),d}function f(a){var c=b(a);return c||(c=e(a)),c.promise()}function g(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(f(a[b]));return c}function h(a){return $.when.apply(null,g(a))}function i(a,b){var e=c(a);e&&(b?h(b).then(function(){d(e,a,b)}):d(e,a))}function j(c,d){return a.putInObject(l,c,new $.Deferred),i(c,d),b(c).promise()}function k(){l={}}var l={};a.namespace("dependencies.checker",{init:k,check:j})}(travi),function(a,b){"use strict";function c(a){var c,d=a.split("."),e=d.length,f=b;try{for(c=0;e>c;c+=1)f=f[d[c]]}catch(g){return!1}return!0}function d(a){var b=new $.Deferred,d=b.promise(),e=a.replace(/\./g,"/");return g.js[a]=d,c(a)?b.resolve():$.getScript(h+e,function(){b.resolve()}),d}function e(a){var b=g.js[a];return b?b:d(a)}function f(){g={js:[]}}var g,h="/resources/js/";a.namespace("dependencies.loader",{load:e,init:f}),f()}(travi,this),travi.templates.preLoad("chooseEnhancement","/resources/thirdparty/travi-core/templates/enhancementVersion.tmpl"),function(a){"use strict";function b(){j.remove(m.ENHANCEMENT_VERSION_KEY),l.refresh()}function c(a,b){$("#"+a+"Version").click(function(){n.update(b)})}function d(){c(m.LARGE_SCREEN_CHOICE,m.LARGE_COOKIE_VALUE)}function e(){c(m.SMALL_SCREEN_CHOICE,m.SMALL_COOKIE_VALUE)}function f(){d(),e(),$("#detectVersion").click(b)}function g(a,b,c){k.render("chooseEnhancement",{alternateEnhancement:a,alternateEnhancementText:b,alternateCommonName:c},function(a){$("footer").append(a),f()})}function h(){var a,b,c,d=j.value(m.ENHANCEMENT_VERSION_KEY);d===m.SMALL_COOKIE_VALUE?(a=m.LARGE_SCREEN_CHOICE,b="large screen",c="desktop"):d===m.LARGE_COOKIE_VALUE&&(a=m.SMALL_SCREEN_CHOICE,b="small screen",c="mobile"),g(a,b,c)}function i(){h()}var j=a.cookies,k=a.templates,l=a.browserProxy,m=a.enhancements.constants.get(),n=a.enhancements.persist;a.namespace("enhancements.choices",{init:i}),i()}(travi),function(a,b){"use strict";function c(a,b){f.publish(a,b)}function d(a,b){f.subscribe(a,b)}function e(a,b){f.unsubscribe(a,b)}var f=b.amplify;a.namespace("events",{publish:c,subscribe:d,unsubscribe:e})}(travi,this),function(a){"use strict";"function"!=typeof Object.create&&(Object.create=function(a){var b=function(){return this};return b.prototype=a,new b}),Array.prototype.remove=function(a,b){var c=this.slice((b||a)+1||this.length);return this.length=0>a?this.length+a:a,this.push.apply(this,c)};var b=function(a,b){$.extend(a,b)},c=function(a,c){var d=Object.create(a);return"object"==typeof c&&b(d,c),d};a.namespace("utilities",{createObjectFrom:c,extendObject:b})}(travi);
//# sourceMappingURL=travi-core.min.js.map