{"version":3,"file":"travi-core.min.js","sources":["../js/travi.js","../js/travi/register.js","../js/travi/constants.js","../js/travi/templates.js","../js/travi/browserProxy.js","../js/travi/cookies.js","../js/travi/enhancements/constants.js","../js/travi/enhancements/persist.js","../js/travi/enhancements/detection.js","../js/travi/dependencies/checker.js","../js/travi/dependencies/loader.js","../js/travi/enhancements/choices.js","../js/travi/events.js","../js/travi/utilities.js"],"names":["global","putIn","object","namespace","provided","i","levels","split","levelCount","length","undefined","getFrom","parts","part","subObject","shift","getStyleSheet","sheetUrl","link","document","createElement","setAttribute","getElementsByTagName","appendChild","ns","this","travi","putInObject","getFromObject","register","dependencies","call","checker","check","set","key","value","ownProp","constantList","get","Object","prototype","hasOwnProperty","loadTemplate","templateName","templateUrl","promise","$","ajax","url","type","dataType","success","template","templates","loadedTemplates","getTemplate","TEMPLATE_DIRECTORY","TEMPLATE_EXT","preLoadTemplates","pathToSingleTemplate","promises","push","when","apply","render","data","renderTemplate","callback","done","init","views","helpers","toLower","string","toLowerCase","preLoad","refresh","location","reload","getNameAndValueFromPair","pair","nameAndValue","name","getNameFromPair","getValueFromCookie","trimLeadingSpaces","charAt","substring","getCookie","qty","currentPair","cookies","cookie","getCookies","exists","getDateNowAdjustedByDays","days","date","Date","setTime","getTime","valueOf","buildExpiresRelativeToNow","toGMTString","create","expires","remove","clearAll","getConstants","ENHANCEMENT_VERSION_KEY","DAYS_BEFORE_ENHANCEMENT_COOKIE_EXPIRATION","SMALL_SCREEN_CHOICE","LARGE_SCREEN_CHOICE","BASIC_CHOICE","LARGE_COOKIE_VALUE","SMALL_COOKIE_VALUE","setEnhancementVersionTo","versionKey","constants","browserProxy","enhancements","update","isSmallScreen","Modernizr","mq","determineSvgSupport","svg","detectEnhancementVersion","persist","setInitialEnhancementVersion","getDeferred","moduleStatuses","getModule","initAndResolve","module","dependency","references","resolve","determineLoadedState","deferred","Deferred","getLoadedStateFor","getPromiseListForDependencies","ensureDependenciesAreLoaded","checkIfLoaded","then","moduleAlreadyDefined","currentLevel","e","load","pathToModule","replace","loaded","js","getScript","PATH_TO_MODULES","resetVersion","configureVersionToggle","choice","sizeVersion","click","configureLargeVersionToggle","configureSmallVersionToggle","configureVersionToggles","addVersionTogglesToDom","alternateEnhancement","alternateEnhancementText","alternateCommonName","renderedTemplate","append","addLinksToChooseVersion","currentEnhancement","publish","eventName","amplify","subscribe","unsubscribe","o","F","Array","from","to","rest","slice","extend","objectToExtend","additionalMembers","createObjectFrom","extendObject"],"mappings":"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"}