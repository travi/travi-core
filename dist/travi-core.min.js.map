{"version":3,"file":"travi-core.min.js","sources":["../js/travi.js","../js/travi/templates.js","../js/travi/browserProxy.js","../js/travi/cookies.js","../js/travi/enhancements/constants.js","../js/travi/enhancements/persist.js","../js/travi/enhancements/detection.js","../js/travi/dependencies/checker.js","../js/travi/dependencies/loader.js","../js/travi/enhancements/choices.js","../js/travi/events.js","../js/travi/utilities.js"],"names":["global","putIn","object","namespace","provided","i","levels","split","levelCount","length","undefined","getFrom","parts","part","subObject","shift","getStyleSheet","sheetUrl","link","document","createElement","setAttribute","getElementsByTagName","appendChild","ns","this","register","dependencies","call","travi","checker","check","constants","set","key","value","ownProp","constantList","get","Object","prototype","hasOwnProperty","putInObject","getFromObject","enableConstants","loadTemplate","templateName","templateUrl","promise","$","ajax","url","type","dataType","success","template","templates","loadedTemplates","getTemplate","TEMPLATE_DIRECTORY","TEMPLATE_EXT","preLoadTemplates","pathToSingleTemplate","promises","push","when","apply","render","data","renderTemplate","callback","done","init","views","helpers","toLower","string","toLowerCase","preLoad","refresh","location","reload","getNameAndValueFromPair","pair","nameAndValue","name","getNameFromPair","getValueFromCookie","trimLeadingSpaces","charAt","substring","getCookie","qty","currentPair","cookies","cookie","getCookies","exists","getDateNowAdjustedByDays","days","date","Date","setTime","getTime","valueOf","buildExpiresRelativeToNow","toGMTString","create","expires","remove","clearAll","getConstants","ENHANCEMENT_VERSION_KEY","DAYS_BEFORE_ENHANCEMENT_COOKIE_EXPIRATION","SMALL_SCREEN_CHOICE","LARGE_SCREEN_CHOICE","BASIC_CHOICE","LARGE_COOKIE_VALUE","SMALL_COOKIE_VALUE","setEnhancementVersionTo","versionKey","browserProxy","enhancements","update","isSmallScreen","Modernizr","mq","determineSvgSupport","svg","detectEnhancementVersion","persist","setInitialEnhancementVersion","getDeferred","moduleStatuses","getModule","initAndResolve","module","dependency","references","resolve","determineLoadedState","deferred","Deferred","getLoadedStateFor","getPromiseListForDependencies","ensureDependenciesAreLoaded","checkIfLoaded","then","moduleAlreadyDefined","currentLevel","e","load","pathToModule","replace","loaded","js","getScript","PATH_TO_MODULES","resetVersion","configureVersionToggle","choice","sizeVersion","click","configureLargeVersionToggle","configureSmallVersionToggle","configureVersionToggles","addVersionTogglesToDom","alternateEnhancement","alternateEnhancementText","alternateCommonName","renderedTemplate","append","addLinksToChooseVersion","currentEnhancement","publish","eventName","amplify","subscribe","unsubscribe","o","F","Array","from","to","rest","slice","extend","objectToExtend","additionalMembers","createObjectFrom","extendObject"],"mappings":"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"}