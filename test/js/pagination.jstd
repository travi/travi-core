travi.test.testCase("PaginationTest", {
    pagination: travi.pagination,

    setUp: function () {
        $('body').append($.render({}, 'pagination'));
        this.pagination.init();

        sinon.stub(travi, 'publish');
    },

    tearDown: function () {
        travi.test.common.restore(travi.publish);
    },

    'test events defined properly': function () {
        assertObject(this.pagination.events);
        assertEquals('next-page-requested', this.pagination.events.NEXT_PAGE_REQUESTED);
        assertEquals('prev-page-requested', this.pagination.events.PREV_PAGE_REQUESTED);
    },

    'test clicking next-page link triggers proper event': function () {
        var call;

        $('a.more').click();

        assert(travi.publish.calledOnce);
        call = travi.publish.getCall(0);
        assertEquals(
            this.pagination.events.NEXT_PAGE_REQUESTED,
            call.args[0]
        );
        assertEquals('/controller/?offset=nextOffset', call.args[1].url);
    },

    'test clicking prev-page link triggers proper event': function () {
        var call;

        $('a.prev').click();

        assert(travi.publish.calledOnce);
        call = travi.publish.getCall(0);
        assertEquals(
            this.pagination.events.PREV_PAGE_REQUESTED,
            call.args[0]
        );
        assertEquals('/controller/?offset=prevOffset', call.args[1].url);
    }
});